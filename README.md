# ID Card Toolkit - 中国公民身份号码极客工具箱

![GitHub stars](https://img.shields.io/github/stars/Liu8Can/cn-id-toolkit?style=social)
![GitHub issues](https://img.shields.io/github/issues/Liu8Can/cn-id-toolkit)
![GitHub last commit](https://img.shields.io/github/last-commit/Liu8Can/cn-id-toolkit)
![License](https://img.shields.io/github/license/Liu8Can/cn-id-toolkit)
![Python Version](https://img.shields.io/badge/python-3.7%2B-blue.svg)

一个为技术爱好者、数据分析师和程序员设计的 Python 命令行工具，用于深度解析、验证、猜测和批量分析中国公民身份号码。本项目不仅是一个实用工具，更是一份关于身份证号码编码规则的深度学习笔记。

## ✨ 功能特性

-   **[解析与画像]**：输入一个18位身份证号，获取其首次户籍登记地（精确到区县）、出生日期、年龄、性别等详细信息。
-   **[逆向猜测]**：提供“地址码 + 出生日期 + 性别”，程序将暴力破解并生成所有可能的有效身份证号码，并支持保存到文件。
-   **[批量数据分析]**：从 `.txt` 文件中读取大量的身份证号码，进行批量校验和分析，最终生成一份包含摘要、人口估算和错误日志的详细报告。
-   **[独立有效性校验]**：快速验证单个身份证号码是否符合国家标准（GB 11643-1999）的所有编码规则。

## ⚙️ 环境准备与安装

本项目基于 Python 3.7+，无需安装任何第三方库。

#### 1. 克隆或下载项目

```bash
git clone https://github.com/Liu8Can/cn-id-toolkit.git
cd cn-id-toolkit
```

#### 2. 准备行政区划代码文件

本工具的地址解析功能依赖于一份行政区划代码文件。

-   请创建一个名为 `pca-code.json` 的文件，并将其放置在项目根目录下。
-   该文件应包含全国省、市、区（县）的三级联动数据。
-   文件格式应如下（`...` 代表更多同级条目）：

```json
[
    {
        "code": "11",
        "name": "北京市",
        "children": [
            {
                "code": "1101",
                "name": "市辖区",
                "children": [
                    {
                        "code": "110101",
                        "name": "东城区"
                    },
                    ...
                ]
            }
        ]
    },
    ...
]
```
> **提示**: 您可以从 GitHub https://github.com/modood/Administrative-divisions-of-China 获得  `JSON` 数据源。
> **备份**：https://github.com/Liu8Can/Administrative-divisions-of-China

#### 3. (可选) 准备待分析的号码列表

如果您需要使用批量分析功能，请创建一个 `.txt` 文件（例如 `id_list.txt`），将待分析的身份证号码放入其中，每行一个。

```
# file: id_list.txt
41010519900101001X
410105199001010020  # 这是一个校验码错误的号码
11010119880808088X
...
```

## 🚀 快速开始

在项目根目录下，通过命令行运行主程序：

```bash
python id_card_toolkit.py
```

程序将启动并显示交互式菜单：

```
===== 中国公民身份号码极客工具箱 (v5.0) =====
1. [解析] - 解析单个身份证号码
2. [猜测] - 根据信息生成所有可能的号码
3. [分析] - 从文件读取号码列表并生成分析报告
4. [验证] - 快速验证单个号码的有效性
5. [退出] - 退出程序
请输入您的选择 (1-5):
```
根据提示输入数字 `1-5` 即可使用相应功能。

## 深度了解：中国公民身份号码编码规则

本工具的所有功能均严格遵循中华人民共和国国家标准。

### 国家标准

-   **GB 11643-1999**: 《公民身份号码》[国家标准|GB 11643-1999](https://openstd.samr.gov.cn/bzgk/gb/newGbInfo?hcno=080D6FBF2BB468F9007657F26D60013E)
-   **GB/T 2260**: 《中华人民共和国行政区划代码》[国家标准|GB/T 2260-2007](https://openstd.samr.gov.cn/bzgk/gb/newGbInfo?hcno=C9C488FD717AFDCD52157F41C3302C6D)

### 号码结构 (18位)

公民身份号码是一个由18位数字（最后一位可能为'X'）组成的特征组合码。

| 位次 (Position) | 1-6 | 7-14 | 15-17 | 18 |
| :--- | :--- | :--- | :--- | :--- |
| **含义 (Meaning)** | **地址码** | **出生日期码** | **顺序码** | **校验码** |

### 各部分详解

#### 1. 地址码 (第1-6位)

-   **标准**: `GB/T 2260`
-   **含义**: 表示编码对象 **首次申领** 身份证时的常住户口所在县（市、旗、区）的行政区划代码。
-   **结构**:
    -   `第1-2位`: 省、自治区、直辖市。
    -   `第3-4位`: 地级市、自治州、盟。
    -   `第5-6位`: 区、县、县级市。
-   **注意**: 此代码一经确定，**终身不变**，即使户口迁移也不会更改。

#### 2. 出生日期码 (第7-14位)

-   **格式**: `YYYYMMDD` (年年年年月月日日)
-   **含义**: 表示编码对象的公历出生日期。

#### 3. 顺序码 (第15-17位)

-   **含义**: 用于对在 **同一地址码**、**同一出生日期码** 的人群进行顺序编号。
-   **性别区分**: 这是通过顺序码实现的 **核心规则**：
    -   **奇数** (`001`, `003`, ..., `999`) 分配给 **男性**。
    -   **偶数** (`002`, `004`, ..., `998`) 分配给 **女性**。
-   **容量**: 理论上，同一天、同一区县最多可为约500名男性和499名女性登记。在现实中，这个容量远超每日新生儿登记数量。

#### 4. 校验码 (第18位)

-   **目的**: 用于检验前17位号码的录入是否正确，是一种**错误校验机制**。
-   **算法**: `ISO 7064:1983, MOD 11-2`
-   **计算公式**:
1.  **加权求和**: 将前17位数字 `a_i` 分别乘以其对应的加权因子 `W_i` 并求和 `S`。
-   `S = a_1*W_1 + a_2*W_2 + ... + a_17*W_17`
-   **加权因子 `W_i` (从第1位到第17位)**:

| 位次 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 |
| :--- | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
| **`W_i`** | 7 | 9 | 10 | 5 | 8 | 4 | 2 | 1 | 6 | 3 | 7 | 9 | 10 | 5 | 8 | 4 | 2 |


2.  **求余**: 计算 `S` 除以 `11` 的余数 `R`。

    -   `R = S mod 11`

3.  **查表**: 根据余数 `R` 查找对应的校验码。

| 余数 `R` | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
| :--- | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :--: |
| **校验码** | 1 | 0 | **X** | 9 | 8 | 7 | 6 | 5 | 4 | 3 | 2 |

-   **关于 'X'**: 当余数为 `2` 时，对应的校验码是 `10`。由于身份证号只能是18位，因此用罗马数字 `X` 来代替 `10`。

## 📁 项目文件结构

```
.
├── id_card_toolkit.py      # 主程序脚本
├── pca-code.json           # (必需) 行政区划代码数据
├── id_list.txt             # (可选) 用于批量分析的号码列表
└── README.md               # 本文档
```

## 🤝 贡献

欢迎提出 Issues 或提交 Pull Requests 来改进这个工具。

## 📜 许可证

本项目采用 [MIT](https://opensource.org/licenses/MIT) 许可证。